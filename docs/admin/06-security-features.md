# 보안 기능 (Security Features)

## 개요
계정 보안을 강화하기 위한 다양한 보안 기능과 정책을 제공합니다.

## 관련 테이블

### 1. user_blacklist
- **위치**: `2021_12_21_102317_create_user_blacklist_table.php`
- **목적**: 차단된 사용자/IP 관리
- **주요 필드**:
  - `type`: 차단 유형 (email/ip/user_id)
  - `value`: 차단 대상 값
  - `reason`: 차단 사유
  - `blocked_until`: 차단 종료 시간
  - `blocked_by`: 차단 처리자

### 2. auth_ip_whitelist
- **위치**: `2025_01_17_000016_create_auth_ip_whitelist_table.php`
- **목적**: 허용 IP 관리
- **주요 필드**:
  - `ip_address`: IP 주소 또는 CIDR
  - `type`: 적용 유형 (user/admin/api)
  - `valid_from`: 유효 시작일
  - `valid_until`: 유효 종료일

### 3. jwt_tokens
- **위치**: `2025_01_16_000001_create_jwt_tokens_table.php`
- **목적**: JWT 토큰 관리
- **주요 필드**:
  - `user_id`: 사용자 ID
  - `token_id`: JWT JTI
  - `token_type`: 토큰 유형 (access/refresh)
  - `revoked`: 폐기 여부
  - `expires_at`: 만료 시간

### 4. auth_email_verifications
- **위치**: `2025_01_01_000006_create_auth_email_verifications_table.php`
- **목적**: 이메일 인증 관리
- **주요 필드**:
  - `email`: 인증 이메일
  - `token`: 인증 토큰
  - `verification_code`: 6자리 코드
  - `attempts`: 시도 횟수

### 5. user_sleeper
- **위치**: `2024_03_24_061726_create_user_sleeper_table.php`
- **목적**: 휴면 계정 관리
- **주요 필드**:
  - `user_id`: 사용자 ID
  - `last_login`: 마지막 로그인
  - `dormant_at`: 휴면 전환일
  - `notified_at`: 통지일

## 보안 정책

### 비밀번호 정책
- **최소 길이**: 8자 이상
- **복잡도**: 대소문자, 숫자, 특수문자 포함
- **변경 주기**: 90일
- **이전 비밀번호**: 최근 5개 재사용 금지
- **유사도 검사**: 이전 비밀번호와 70% 이상 다름

### 로그인 보안
- **실패 제한**: 5회 실패 시 15분 잠금
- **브루트포스 방지**: IP당 시간당 10회 제한
- **비정상 접속 감지**: 새로운 위치/디바이스 알림
- **동시 세션**: 최대 3개 디바이스

### 2단계 인증 (2FA)
- **지원 방식**:
  - SMS OTP
  - 이메일 OTP
  - Google Authenticator
  - 백업 코드

### IP 관리
- **화이트리스트**: 관리자 접속 IP 제한
- **블랙리스트**: 악의적 IP 차단
- **지역 제한**: 특정 국가/지역 차단
- **VPN/프록시 감지**: 의심 IP 추가 인증

## 휴면 계정 처리

### 휴면 전환 프로세스
1. **90일 미접속**: 휴면 예고 이메일
2. **180일 미접속**: 휴면 전환
3. **휴면 계정 처리**:
   - 개인정보 별도 저장
   - 로그인 차단
   - 재활성화 절차 필요

### 재활성화
1. 이메일/SMS 인증
2. 비밀번호 재설정
3. 약관 재동의
4. 계정 복구 완료

## 토큰 보안

### JWT 토큰 정책
- **Access Token**: 15분 유효
- **Refresh Token**: 7일 유효
- **토큰 저장**: HttpOnly 쿠키
- **토큰 갱신**: 자동 갱신

### 토큰 폐기
- 로그아웃 시 즉시 폐기
- 비밀번호 변경 시 전체 폐기
- 의심 활동 감지 시 폐기

## 감사 및 모니터링

### 실시간 모니터링
- 동시 로그인 감지
- 비정상 패턴 감지
- 대량 요청 감지

### 보안 이벤트 알림
- **즉시 알림**:
  - 비밀번호 변경
  - 새 디바이스 로그인
  - 권한 변경

- **일별 요약**:
  - 로그인 실패 통계
  - 차단 IP 목록
  - 의심 활동 요약

## 데이터 보호

### 암호화
- 비밀번호: bcrypt 해싱
- 민감 정보: AES-256 암호화
- 전송 구간: TLS 1.3

### 개인정보 보호
- 최소 수집 원칙
- 목적 외 사용 금지
- 제3자 제공 제한
- 안전한 폐기

## 컴플라이언스

### GDPR 준수
- 정보 이동권
- 삭제권 (잊혀질 권리)
- 처리 제한권
- 정보 접근권

### 국내 규정
- 개인정보보호법 준수
- 정보통신망법 준수
- 전자금융거래법 준수