# 회원가입 기능 체크리스트

## 📋 목차
1. [기본 회원가입 기능](#1-기본-회원가입-기능)
2. [가입 모드](#2-가입-모드)
3. [입력값 검증](#3-입력값-검증)
4. [비밀번호 검증](#4-비밀번호-검증)
5. [약관 관리](#5-약관-관리)
6. [이메일 검증](#6-이메일-검증)
7. [보안 검증](#7-보안-검증)
8. [계정 생성](#8-계정-생성)
9. [가입 후 처리](#9-가입-후-처리)
10. [샤딩 지원](#10-샤딩-지원)
11. [보너스 시스템](#11-보너스-시스템)
12. [UI/UX](#12-uiux)

---

## 1. 기본 회원가입 기능

### 1.1 회원가입 폼 표시
- [x] `/register` 경로 접속 시 가입 폼 표시 ✅
- [x] 이름 입력 필드 표시 ✅
- [x] 이메일 입력 필드 표시 ✅
- [x] 비밀번호 입력 필드 표시 ✅
- [x] 비밀번호 확인 필드 표시 ✅
- [x] 약관 동의 체크박스 표시 ✅ (약관 존재 시)
- [x] "회원가입" 버튼 표시 ✅
- [x] "로그인" 링크 표시 ✅

### 1.2 회원가입 처리
- [x] POST `/register` 요청 처리 ✅
- [x] 트랜잭션으로 모든 작업 보장 ✅
- [x] 성공 시 성공 화면 또는 로그인 페이지로 이동 ✅
- [x] 실패 시 에러 메시지와 함께 폼 유지 ✅
- [x] 입력값 유지 (비밀번호 제외) ✅

### 1.3 회원가입 비활성화
- [x] `register.enable=false` 시 비활성화 화면 표시 ✅
- [x] 비활성화 화면에 안내 메시지 표시 ✅
- [x] 로그인 페이지로 돌아가기 링크 ✅

---

## 2. 가입 모드

### 2.1 Simple 모드 (`mode=simple`)
- [x] 한 페이지에서 약관 + 정보 입력 ✅
- [x] `register.index` 뷰 표시 ✅
- [x] 약관과 입력 필드 동시 표시 ✅
- [x] 한 번에 제출 ✅

### 2.2 Step 모드 (`mode=step`)
- [x] 1단계: 약관 동의 페이지 (`register.terms`) ✅
- [x] 2단계: 정보 입력 페이지 (`register.index`) ✅
- [ ] 단계 표시 UI ⏳
- [ ] 다음/이전 버튼 ⏳
- [ ] 세션에 1단계 데이터 저장 ⏳

---

## 3. 입력값 검증

### 3.1 필수 필드 검증
- [x] 이름: 필수 입력 ✅
- [x] 이메일: 필수 입력 ✅
- [x] 비밀번호: 필수 입력 ✅
- [x] 비밀번호 확인: 필수 입력 ✅
- [x] 약관 동의: 필수 약관 모두 체크 ✅

### 3.2 형식 검증
- [x] 이름: 2자 이상 ✅
- [x] 이메일: 올바른 이메일 형식 ✅
- [x] 이메일: 중복 확인 ✅
- [x] 비밀번호: 비밀번호 확인과 일치 ✅
- [x] 전화번호: 올바른 형식 (선택 필드) ✅

### 3.3 선택 필드 (`register.fields.*`)
- [x] `phone=true` 시 전화번호 필드 표시 ✅
- [ ] `birth_date=true` 시 생년월일 필드 표시 ⏳
- [ ] `gender=true` 시 성별 필드 표시 ⏳
- [ ] `address=true` 시 주소 필드 표시 ⏳

---

## 4. 비밀번호 검증

### 4.1 비밀번호 규칙 (`password_rules.*`)
- [x] `min_length=8`: 8자 이상 ✅
- [x] `require_uppercase=true`: 대문자 포함 ✅
- [x] `require_lowercase=true`: 소문자 포함 ✅
- [x] `require_numbers=true`: 숫자 포함 ✅
- [x] `require_symbols=true`: 특수문자 포함 ✅

### 4.2 추가 검증
- [ ] 연속 문자 제외 (abc, 123, aaa) ⏳
- [ ] 일반적인 비밀번호 제외 (password, 12345678) ⏳
- [ ] 이메일과 동일한 비밀번호 제외 ⏳
- [x] 비밀번호 강도 표시 (UI) ✅ 실시간 진행바

---

## 5. 약관 관리

### 5.1 약관 로드
- [x] 필수 약관 로드 (`is_mandatory=true`) ✅
- [x] 선택 약관 로드 (`is_mandatory=false`) ✅
- [x] 활성화된 약관만 표시 (`is_active=true`) ✅
- [ ] 유효 기간 확인 (`effective_date`, `expired_date`) ⏳
- [ ] 카테고리별 그룹화 ⏳

### 5.2 약관 동의 검증
- [x] 필수 약관 모두 체크 확인 ✅
- [x] 선택 약관은 선택적 ✅
- [x] "전체 동의" 체크박스 기능 ✅
- [x] 약관 내용 모달 표시 ✅

### 5.3 약관 동의 기록
- [x] `user_terms_agreements` 테이블 저장 ✅
- [x] 약관 ID, 버전 기록 ✅
- [x] 동의 시간, IP 주소 기록 ✅
- [x] User Agent 기록 ✅

---

## 6. 이메일 검증

### 6.1 예약 이메일 차단
- [x] `admin@` 차단 ✅
- [x] `support@` 차단 ✅
- [x] `info@` 차단 ✅
- [x] `noreply@` 차단 ✅
- [x] `postmaster@` 차단 ✅

### 6.2 임시 이메일 차단 (`blocked_email_domains`)
- [x] `tempmail.com` 차단 ✅
- [x] `10minutemail.com` 차단 ✅
- [x] `guerrillamail.com` 차단 ✅
- [x] `mailinator.com` 차단 ✅
- [x] `throwaway.email` 차단 ✅

### 6.3 이메일 중복 확인
- [x] DB에서 이메일 존재 여부 확인 ✅
- [x] 샤딩 활성화 시 인덱스 테이블 조회 ✅
- [x] 중복 시 "이미 사용 중인 이메일" 메시지 ✅

---

## 7. 보안 검증

### 7.1 블랙리스트 확인 (`blacklist.enable=true`)
- [x] 이메일 블랙리스트 확인 ✅
- [x] IP 블랙리스트 확인 ✅
- [x] IP 범위 블랙리스트 확인 (CIDR) ✅
- [x] 차단 시 "차단된 이메일/IP" 메시지 ✅

### 7.2 reCAPTCHA 검증
- [x] `recaptcha.enable=true` 시 reCAPTCHA 표시 ✅ (현재 비활성)
- [x] v2: 체크박스 검증 ✅
- [x] v3: 점수 검증 (min_score=0.5) ✅
- [x] 실패 시 "보안 검증 실패" 메시지 ✅

### 7.3 IP 화이트리스트
- [x] `ip_whitelist.enable=true` 시 IP 확인 ✅ (현재 비활성)
- [x] 허용 IP만 가입 가능 ✅
- [x] 차단된 IP 접근 시 에러 메시지 ✅

---

## 8. 계정 생성

### 8.1 사용자 기본 정보 생성 (`users`)
- [x] name 저장 ✅
- [x] email 저장 (unique) ✅
- [x] password 해시 저장 ✅
- [x] uuid 생성 ✅
- [x] utype='USR' 설정 ✅
- [x] account_status 설정 (active/pending) ✅
- [x] email_verified_at 설정 ✅
- [x] created_at, updated_at 자동 저장 ✅

### 8.2 사용자 프로필 생성 (`user_profiles`)
- [x] user_id 저장 ✅
- [x] user_uuid 저장 ✅
- [x] phone 저장 ✅
- [ ] birth_date 저장 ⏳
- [ ] gender 저장 ⏳
- [ ] marketing_consent 저장 ⏳
- [ ] sms_consent 저장 ⏳

### 8.3 약관 동의 기록 (`user_terms_agreements`)
- [x] user_id 저장 ✅
- [x] term_id 저장 ✅
- [x] term_version 저장 ✅
- [x] agreed_at 저장 ✅
- [x] ip_address 저장 ✅
- [x] user_agent 저장 ✅

### 8.4 이메일 인증 토큰 생성 (`auth_email_verifications`)
- [x] user_id 저장 ✅
- [x] email 저장 ✅
- [x] token 생성 (64자) ✅
- [x] verification_code 생성 (6자리) ✅
- [x] type='register' 설정 ✅
- [x] expires_at 설정 (24시간) ✅

### 8.5 트랜잭션 보장
- [x] 모든 작업이 트랜잭션 내 실행 ✅
- [x] 실패 시 전체 롤백 ✅
- [x] 부분 생성 방지 ✅

---

## 9. 가입 후 처리

### 9.1 이메일 인증 필요 (`require_email_verification=true`)
- [x] 인증 메일 발송 ✅
- [x] 인증 대기 화면 표시 ✅
- [x] "메일을 확인해주세요" 메시지 ✅
- [x] 재발송 링크 표시 ✅
- [x] 로그인 불가 상태 ✅

### 9.2 관리자 승인 필요 (`require_approval=true`)
- [x] account_status='pending' 설정 ✅
- [x] 승인 대기 화면 표시 ✅
- [x] "관리자 승인 대기 중" 메시지 ✅
- [x] 로그인 불가 상태 ✅

### 9.3 자동 로그인 (`auto_login=true`)
- [x] 가입 즉시 로그인 ✅
- [x] JWT 토큰 생성 (JWT 모드) ✅
- [x] 세션 생성 (Session 모드) ✅
- [x] `/home`으로 리다이렉트 ✅

### 9.4 일반 가입 (기본값)
- [x] 성공 화면 표시 또는 `/login`으로 리다이렉트 ✅
- [x] "회원가입 완료" 메시지 ✅
- [x] 로그인 안내 ✅

---

## 10. 샤딩 지원

### 10.1 샤딩 활성화 (`sharding.enable=true`)
- [ ] ShardedUser::createUser() 사용
- [ ] UUID 자동 생성
- [ ] 16개 샤드 중 해시로 선택
- [ ] 이메일 인덱스 테이블 저장
- [ ] user_id는 null 허용

### 10.2 샤딩 비활성화 (`sharding.enable=false`)
- [ ] User::create() 사용
- [ ] ID 자동 증가
- [ ] UUID도 함께 생성
- [ ] 단일 DB 저장

---

## 11. 보너스 시스템

### 11.1 가입 보너스 (`signup_bonus.enable=true`)
- [x] 포인트 보너스 지급 ✅ (현재 비활성)
- [x] 금액: `signup_bonus.amount` (기본 1000P) ✅
- [x] `user_emoney` 테이블 레코드 생성 ✅
- [x] `user_emoney_log` 거래 기록 ✅
- [x] balance 업데이트 ✅

### 11.2 포인트 시스템 (`point.enable=true`)
- [x] 회원가입 보너스: 1000P ✅
- [x] 포인트 내역 저장 ✅
- [x] 포인트 유효기간 설정 (365일) ✅

---

## 12. UI/UX

### 12.1 회원가입 화면
- [x] Bootstrap 테마 적용 ✅
- [x] 반응형 디자인 ✅
- [x] 로고 표시 ✅
- [x] 에러 메시지 표시 ✅ 상세 리스트 형식
- [x] 입력값 유지 (old 값) ✅
- [x] 실시간 유효성 검사 (JavaScript) ✅

### 12.2 비밀번호 강도 표시
- [x] 약함/보통/강함 표시 ✅ 진행바 + 텍스트
- [x] 충족 조건 표시 (대문자, 소문자, 숫자, 특수문자) ✅ 5가지 규칙
- [x] 색상으로 강도 구분 ✅ 빨강/노랑/초록

### 12.3 전체 동의 기능
- [x] "전체 동의" 체크 시 모든 약관 체크 ✅
- [x] "전체 동의" 해제 시 모든 약관 해제 ✅
- [x] JavaScript로 동작 ✅

### 12.4 약관 모달
- [x] 약관 내용 모달로 표시 ✅
- [x] HTML 렌더링 ✅
- [x] 스크롤 가능 ✅
- [x] 닫기 버튼 ✅

---

## 📊 설정별 테스트 매트릭스

| 설정 항목 | 값 | 테스트 항목 | 예상 결과 |
|---------|-----|----------|----------|
| `register.enable` | `true` | /register 접속 | ✅ 가입 폼 표시 |
| `register.enable` | `false` | /register 접속 | ❌ 비활성화 화면 |
| `register.mode` | `simple` | /register 접속 | 약관+정보 한 페이지 |
| `register.mode` | `step` | /register 접속 | 약관 동의 페이지 |
| `require_approval` | `true` | 가입 완료 | status='pending' |
| `require_approval` | `false` | 가입 완료 | status='active' |
| `require_email_verification` | `true` | 가입 완료 | 인증 메일 발송 |
| `require_email_verification` | `false` | 가입 완료 | 즉시 활성화 |
| `auto_login` | `true` | 가입 완료 | 자동 로그인 + /home |
| `auto_login` | `false` | 가입 완료 | /login 리다이렉트 |
| `signup_bonus.enable` | `true` | 가입 완료 | 1000P 지급 |
| `signup_bonus.enable` | `false` | 가입 완료 | 보너스 없음 |
| `sharding.enable` | `true` | 사용자 생성 | ShardedUser 사용 |
| `sharding.enable` | `false` | 사용자 생성 | User 모델 사용 |
| `recaptcha.enable` | `true` | 가입 화면 | reCAPTCHA 표시 |
| `recaptcha.enable` | `false` | 가입 화면 | reCAPTCHA 숨김 |

---

## ✅ 상세 테스트 시나리오

### TC-R001: 정상 회원가입 (Simple 모드)
```
설정:
- mode=simple
- require_email_verification=true
- require_approval=false
- auto_login=false

단계:
1. /register 접속
2. 이름: 홍길동
3. 이메일: user@example.com
4. 비밀번호: Password123!
5. 비밀번호 확인: Password123!
6. 필수 약관 체크
7. 회원가입 버튼 클릭
8. ✅ 계정 생성 (status=active)
9. ✅ 이메일 인증 메일 발송
10. ✅ 인증 안내 화면 표시
11. ✅ 로그인 불가 (email_verified_at=null)
```

### TC-R002: Step 모드 회원가입
```
설정:
- mode=step
- require_email_verification=false
- auto_login=true

단계:
1. /register 접속
2. ✅ 약관 동의 페이지 표시
3. 필수 약관 체크
4. "다음" 버튼 클릭
5. ✅ 정보 입력 페이지 표시
6. 이름, 이메일, 비밀번호 입력
7. 회원가입 버튼 클릭
8. ✅ 계정 생성
9. ✅ 자동 로그인
10. ✅ /home 리다이렉트
```

### TC-R003: 관리자 승인 필요
```
설정:
- require_approval=true
- require_email_verification=true

단계:
1. 회원가입 완료
2. ✅ status='pending' 저장
3. ✅ 승인 대기 화면 표시
4. ✅ 로그인 시도 → "승인 대기 중" 메시지
5. 관리자가 승인
6. ✅ status='active' 변경
7. ✅ 로그인 가능
```

### TC-R004: 샤딩 모드 회원가입
```
설정:
- sharding.enable=true
- shard_count=16

단계:
1. 회원가입 완료
2. ✅ UUID 자동 생성
3. ✅ 해시 계산 (UUID → 샤드 번호)
4. ✅ users_shard_{N} 테이블 저장
5. ✅ user_email_index 테이블 저장
6. ✅ user_id=null (ID 사용 안 함)
```

### TC-R005: 가입 보너스 지급
```
설정:
- signup_bonus.enable=true
- signup_bonus.amount=1000
- point.enable=true

단계:
1. 회원가입 완료
2. ✅ user_emoney 레코드 생성
3. ✅ balance=1000
4. ✅ total_earned=1000
5. ✅ user_emoney_log 기록
   - transaction_type='earn'
   - amount=1000
   - description='회원가입 보너스'
```

---

## 🧪 입력값 검증 테스트

### 이름 검증

| TC # | 입력값 | 예상 결과 | 메시지 |
|------|--------|----------|--------|
| TC-R101 | 홍길동 | ✅ 통과 | - |
| TC-R102 | 김 | ❌ 실패 | "이름은 2자 이상" |
| TC-R103 | (공백) | ❌ 실패 | "이름 필수" |
| TC-R104 | 가나다라마바사아자차카타파하 | ✅ 통과 | - |

### 이메일 검증

| TC # | 입력값 | 예상 결과 | 메시지 |
|------|--------|----------|--------|
| TC-R201 | user@example.com | ✅ 통과 | - |
| TC-R202 | invalid-email | ❌ 실패 | "올바른 이메일 형식" |
| TC-R203 | (공백) | ❌ 실패 | "이메일 필수" |
| TC-R204 | admin@example.com | ❌ 실패 | "예약된 이메일" |
| TC-R205 | user@tempmail.com | ❌ 실패 | "임시 이메일 사용 불가" |
| TC-R206 | existing@example.com | ❌ 실패 | "이미 사용 중인 이메일" |

### 비밀번호 검증

| TC # | 입력값 | 규칙 충족 | 예상 결과 | 메시지 |
|------|--------|---------|----------|--------|
| TC-R301 | Password123! | 모두 충족 | ✅ 통과 | - |
| TC-R302 | pass | 8자 미만 | ❌ 실패 | "8자 이상" |
| TC-R303 | password123! | 대문자 없음 | ❌ 실패 | "대문자 포함 필요" |
| TC-R304 | PASSWORD123! | 소문자 없음 | ❌ 실패 | "소문자 포함 필요" |
| TC-R305 | PasswordABC! | 숫자 없음 | ❌ 실패 | "숫자 포함 필요" |
| TC-R306 | Password123 | 특수문자 없음 | ❌ 실패 | "특수문자 포함 필요" |
| TC-R307 | password | 모두 미충족 | ❌ 실패 | "비밀번호 규칙 위반" |
| TC-R308 | 12345678 | 일반 비밀번호 | ❌ 실패 | "안전하지 않은 비밀번호" |
| TC-R309 | Pass123! | 확인 불일치 | ❌ 실패 | "비밀번호 불일치" |

### 약관 동의 검증

| TC # | 필수 약관 | 선택 약관 | 예상 결과 | 메시지 |
|------|---------|---------|----------|--------|
| TC-R401 | 모두 체크 | - | ✅ 통과 | - |
| TC-R402 | 1개 미체크 | - | ❌ 실패 | "필수 약관 모두 동의 필요" |
| TC-R403 | 모두 체크 | 미체크 | ✅ 통과 | - |
| TC-R404 | 전체 동의 체크 | - | ✅ 모두 체크됨 | - |

---

## 🔄 통합 시나리오

### 시나리오 A: 완전한 회원가입 (모든 기능)
```
설정:
- mode=simple
- require_email_verification=true
- require_approval=true
- signup_bonus.enable=true
- recaptcha.enable=true

프로세스:
1. /register 접속
2. reCAPTCHA 검증
3. 약관 동의 + 정보 입력
4. 회원가입 제출
5. ✅ 트랜잭션 시작
   ├─ User 생성 (status=pending)
   ├─ UserProfile 생성
   ├─ 약관 동의 기록
   ├─ 이메일 인증 토큰 생성
   ├─ 1000P 보너스 지급
   └─ 활동 로그 기록
6. ✅ 트랜잭션 커밋
7. ✅ 인증 메일 발송
8. ✅ 승인 대기 화면 표시
9. ❌ 로그인 불가 (pending + 이메일 미인증)
```

### 시나리오 B: 빠른 가입 (최소 설정)
```
설정:
- mode=simple
- require_email_verification=false
- require_approval=false
- auto_login=true

프로세스:
1. /register 접속
2. 약관 동의 + 정보 입력
3. 회원가입 제출
4. ✅ User 생성 (status=active, email_verified_at=now())
5. ✅ UserProfile 생성
6. ✅ 약관 동의 기록
7. ✅ 자동 로그인
8. ✅ JWT 토큰 생성
9. ✅ /home 리다이렉트
```

### 시나리오 C: 이메일 인증 프로세스
```
설정:
- require_email_verification=true
- auto_login=false

프로세스:
1. 회원가입 완료
2. ✅ 인증 메일 발송
   - 제목: "이메일 인증"
   - 인증 링크 포함
   - 6자리 코드 포함
3. 사용자가 이메일 클릭
4. ✅ /email/verify?token=xxx 접속
5. ✅ 토큰 검증 (24시간 유효)
6. ✅ email_verified_at 업데이트
7. ✅ "인증 완료" 화면
8. ✅ 로그인 가능
```

### 시나리오 D: 샤딩 모드 가입
```
설정:
- sharding.enable=true
- shard_count=16
- use_index_tables=true

프로세스:
1. 회원가입 제출
2. ✅ UUID 생성: "550e8400-e29b-41d4-a716-446655440000"
3. ✅ 해시 계산: hash(UUID) % 16 = 5
4. ✅ users_shard_5 테이블 INSERT
5. ✅ user_email_index INSERT
   - email: user@example.com
   - uuid: 550e8400-...
   - shard_number: 5
6. ✅ user_profiles INSERT (user_uuid 사용)
```

### 시나리오 E: 에러 처리
```
단계별 검증 실패:

1. 시스템 비활성화
   ├─ register.enable=false
   └─ ❌ 비활성화 화면

2. 입력값 검증 실패
   ├─ 이메일 형식 오류
   └─ ❌ "올바른 이메일 형식"

3. 예약 이메일
   ├─ admin@example.com
   └─ ❌ "예약된 이메일"

4. 블랙리스트
   ├─ IP 차단됨
   └─ ❌ "차단된 IP"

5. 비밀번호 규칙
   ├─ password (약함)
   └─ ❌ "비밀번호 규칙 위반"

6. 약관 미동의
   ├─ 필수 약관 미체크
   └─ ❌ "필수 약관 동의 필요"

7. reCAPTCHA 실패
   ├─ 점수 < 0.5
   └─ ❌ "보안 검증 실패"

8. 트랜잭션 실패
   ├─ DB 에러
   └─ ❌ 전체 롤백
```

---

## 🎯 테스트 커버리지

### 기능별 테스트 개수

| 카테고리 | 필수 | 중요 | 권장 | 선택 | 총 |
|---------|-----|-----|-----|-----|-----|
| 기본 가입 | 8 | 5 | 2 | 0 | 15 |
| 가입 모드 | 2 | 4 | 0 | 0 | 6 |
| 입력값 검증 | 15 | 8 | 5 | 0 | 28 |
| 비밀번호 검증 | 8 | 4 | 2 | 0 | 14 |
| 약관 검증 | 6 | 4 | 2 | 0 | 12 |
| 이메일 검증 | 6 | 3 | 2 | 0 | 11 |
| 보안 검증 | 4 | 6 | 4 | 2 | 16 |
| 계정 생성 | 10 | 8 | 0 | 0 | 18 |
| 가입 후 처리 | 8 | 6 | 2 | 0 | 16 |
| 샤딩 | 0 | 0 | 4 | 6 | 10 |
| 보너스 | 0 | 4 | 2 | 0 | 6 |
| UI/UX | 4 | 8 | 6 | 2 | 20 |
| **합계** | **71** | **60** | **31** | **10** | **172** |

**최소 테스트**: 71개 (P0)  
**권장 테스트**: 131개 (P0 + P1)  
**전체 테스트**: 172개 (All)

---

## 🔬 세부 테스트 케이스

### 1. 시스템 활성화 테스트

| TC # | Config | 테스트 | Expected | Priority |
|------|--------|--------|----------|----------|
| TC-R1001 | `register.enable=true` | /register 접속 | 가입 폼 표시 | P0 |
| TC-R1002 | `register.enable=false` | /register 접속 | 비활성화 화면 | P1 |

### 2. 입력값 검증 테스트

| TC # | 필드 | 입력값 | Expected | Priority |
|------|------|--------|----------|----------|
| TC-R2001 | name | 홍길동 | ✅ 통과 | P0 |
| TC-R2002 | name | 김 | ❌ "2자 이상" | P0 |
| TC-R2003 | name | (공백) | ❌ "이름 필수" | P0 |
| TC-R2004 | email | user@example.com | ✅ 통과 | P0 |
| TC-R2005 | email | invalid | ❌ "이메일 형식" | P0 |
| TC-R2006 | email | (공백) | ❌ "이메일 필수" | P0 |
| TC-R2007 | password | Password123! | ✅ 통과 | P0 |
| TC-R2008 | password | pass | ❌ "8자 이상" | P0 |
| TC-R2009 | password_confirmation | Password123! | ✅ 통과 | P0 |
| TC-R2010 | password_confirmation | Different123! | ❌ "불일치" | P0 |

### 3. 비밀번호 규칙 테스트

| TC # | 비밀번호 | 대문자 | 소문자 | 숫자 | 특수문자 | Expected | Priority |
|------|---------|-------|-------|-----|---------|----------|----------|
| TC-R3001 | Password123! | ✅ | ✅ | ✅ | ✅ | ✅ 통과 | P0 |
| TC-R3002 | password123! | ❌ | ✅ | ✅ | ✅ | ❌ 대문자 필요 | P0 |
| TC-R3003 | PASSWORD123! | ✅ | ❌ | ✅ | ✅ | ❌ 소문자 필요 | P0 |
| TC-R3004 | PasswordABC! | ✅ | ✅ | ❌ | ✅ | ❌ 숫자 필요 | P0 |
| TC-R3005 | Password123 | ✅ | ✅ | ✅ | ❌ | ❌ 특수문자 필요 | P0 |
| TC-R3006 | Pass1! | ✅ | ✅ | ✅ | ✅ | ❌ 8자 미만 | P0 |

### 4. 약관 동의 테스트

| TC # | 필수 약관 수 | 체크된 필수 | 예상 결과 | Priority |
|------|-----------|-----------|----------|----------|
| TC-R4001 | 3개 | 3개 | ✅ 통과 | P0 |
| TC-R4002 | 3개 | 2개 | ❌ "필수 약관 동의" | P0 |
| TC-R4003 | 3개 | 0개 | ❌ "필수 약관 동의" | P0 |
| TC-R4004 | 0개 (약관 없음) | - | ✅ 통과 | P1 |

### 5. 이메일 검증 테스트

| TC # | 이메일 | 사유 | Expected | Priority |
|------|--------|------|----------|----------|
| TC-R5001 | admin@example.com | 시스템 예약 | ❌ "예약된 이메일" | P1 |
| TC-R5002 | support@example.com | 시스템 예약 | ❌ "예약된 이메일" | P1 |
| TC-R5003 | user@tempmail.com | 임시 이메일 | ❌ "사용 불가" | P1 |
| TC-R5004 | user@10minutemail.com | 임시 이메일 | ❌ "사용 불가" | P1 |
| TC-R5005 | existing@example.com | 중복 | ❌ "이미 사용 중" | P0 |

### 6. 블랙리스트 테스트

| TC # | 블랙리스트 유형 | 테스트 | Expected | Priority |
|------|--------------|--------|----------|----------|
| TC-R6001 | 이메일 블랙리스트 | 가입 시도 | ❌ "차단된 이메일" | P1 |
| TC-R6002 | IP 블랙리스트 | 가입 시도 | ❌ "차단된 IP" | P1 |
| TC-R6003 | IP 범위 (CIDR) | 가입 시도 | ❌ "차단된 IP" | P2 |

### 7. 가입 후 상태 테스트

| TC # | 설정 조합 | 최종 상태 | 로그인 가능 | Priority |
|------|---------|---------|-----------|----------|
| TC-R7001 | approval=false, email=false | active, verified | ✅ 즉시 | P0 |
| TC-R7002 | approval=false, email=true | active, unverified | ❌ 인증 필요 | P0 |
| TC-R7003 | approval=true, email=false | pending, verified | ❌ 승인 필요 | P1 |
| TC-R7004 | approval=true, email=true | pending, unverified | ❌ 둘 다 필요 | P1 |

### 8. 샤딩 테스트

| TC # | Config | 테스트 | Expected | Priority |
|------|--------|--------|----------|----------|
| TC-R8001 | `sharding.enable=true` | 계정 생성 | ShardedUser::createUser() | P3 |
| TC-R8002 | `sharding.enable=true` | UUID 확인 | v4 UUID 생성 | P3 |
| TC-R8003 | `sharding.enable=true` | 샤드 번호 | 0~15 중 하나 | P3 |
| TC-R8004 | `sharding.enable=true` | 인덱스 테이블 | user_email_index 저장 | P3 |
| TC-R8005 | `sharding.enable=false` | 계정 생성 | User::create() | P0 |
| TC-R8006 | `sharding.enable=false` | ID 확인 | Auto Increment | P0 |

### 9. 보너스 지급 테스트

| TC # | Config | 테스트 | Expected | Priority |
|------|--------|--------|----------|----------|
| TC-R9001 | `signup_bonus.enable=true` | 가입 완료 | 1000P 지급 | P2 |
| TC-R9002 | `signup_bonus.enable=true` | user_emoney 확인 | balance=1000 | P2 |
| TC-R9003 | `signup_bonus.enable=true` | 거래 로그 | transaction_type='earn' | P2 |
| TC-R9004 | `signup_bonus.enable=false` | 가입 완료 | 보너스 없음 | P1 |

---

## 🎭 에러 처리 테스트

### 검증 실패 순서

| 순서 | 검증 단계 | 실패 시 메시지 | Priority |
|-----|---------|-------------|----------|
| 1 | 시스템 활성화 | "회원가입이 중단되었습니다" | P1 |
| 2 | 입력값 검증 | "필수 입력 항목" | P0 |
| 3 | 예약 이메일 | "예약된 이메일" | P1 |
| 4 | 블랙리스트 | "차단된 이메일/IP" | P1 |
| 5 | 비밀번호 규칙 | "비밀번호 규칙 위반" | P0 |
| 6 | 약관 동의 | "필수 약관 동의 필요" | P0 |
| 7 | reCAPTCHA | "보안 검증 실패" | P2 |
| 8 | 계정 생성 | "회원가입 실패" | P0 |

---

## 📱 API 응답 테스트

### 성공 응답

| TC # | 시나리오 | 응답 필드 | Expected | Priority |
|------|---------|---------|----------|----------|
| TC-RA001 | 일반 가입 | `success: true` | ✅ | P0 |
| TC-RA002 | 일반 가입 | `user.id` | 숫자 | P0 |
| TC-RA003 | 일반 가입 | `user.email` | 입력 이메일 | P0 |
| TC-RA004 | 자동 로그인 | `tokens.access_token` | JWT 문자열 | P1 |
| TC-RA005 | 자동 로그인 | `tokens.refresh_token` | JWT 문자열 | P1 |

### 실패 응답

| TC # | 실패 사유 | 응답 코드 | Expected | Priority |
|------|---------|---------|----------|----------|
| TC-RA101 | 비밀번호 규칙 | `INVALID_PASSWORD` | HTTP 422 | P0 |
| TC-RA102 | 약관 미동의 | `TERMS_NOT_AGREED` | HTTP 422 | P0 |
| TC-RA103 | 블랙리스트 | `BLACKLISTED` | HTTP 403 | P1 |
| TC-RA104 | 시스템 비활성화 | `SYSTEM_DISABLED` | HTTP 503 | P1 |

---

## 🗄️ 데이터베이스 검증

### 테이블별 생성 확인

| TC # | 테이블 | 확인 항목 | Expected | Priority |
|------|--------|---------|----------|----------|
| TC-RD001 | users | 레코드 생성됨 | ✅ 1 row | P0 |
| TC-RD002 | users | uuid 존재 | UUID v4 형식 | P0 |
| TC-RD003 | users | password 해시 | bcrypt 해시 | P0 |
| TC-RD004 | users | status | active/pending | P0 |
| TC-RD005 | user_profiles | 레코드 생성됨 | ✅ 1 row | P0 |
| TC-RD006 | user_profiles | user_uuid | users.uuid 일치 | P0 |
| TC-RD007 | user_terms_agreements | 약관 개수만큼 | N rows | P1 |
| TC-RD008 | auth_email_verifications | 인증 토큰 | 64자 문자열 | P1 |
| TC-RD009 | user_emoney | 보너스 지급됨 | balance=1000 | P2 |
| TC-RD010 | user_emoney_log | 거래 기록 | 1 row | P2 |

---

## 🔧 테스트 환경 설정

### 기본 설정 (최소 기능)
```php
'register' => [
    'enable' => true,
    'mode' => 'simple',
    'require_approval' => false,
    'require_email_verification' => false,
    'auto_login' => false,
],
'password_rules' => [
    'min_length' => 8,
    'require_uppercase' => true,
    'require_lowercase' => true,
    'require_numbers' => true,
    'require_symbols' => true,
],
'sharding' => ['enable' => false],
'signup_bonus' => ['enable' => false],
```

### 권장 설정 (표준 운영)
```php
'register' => [
    'enable' => true,
    'mode' => 'simple',
    'require_approval' => false,
    'require_email_verification' => true,
    'auto_login' => false,
],
'password_rules' => [
    'min_length' => 8,
    'require_uppercase' => true,
    'require_lowercase' => true,
    'require_numbers' => true,
    'require_symbols' => true,
],
'security' => [
    'recaptcha' => ['enable' => false],
],
'blacklist' => ['enable' => true],
'signup_bonus' => ['enable' => true, 'amount' => 1000],
```

### 고급 설정 (모든 기능)
```php
'register' => [
    'enable' => true,
    'mode' => 'step',
    'require_approval' => true,
    'require_email_verification' => true,
    'auto_login' => false,
],
'security' => [
    'recaptcha' => [
        'enable' => true,
        'version' => 'v3',
        'min_score' => 0.5,
    ],
    'ip_whitelist' => [
        'enable' => true,
        'ips' => ['127.0.0.1', '::1'],
    ],
],
'blacklist' => ['enable' => true],
'sharding' => ['enable' => true, 'shard_count' => 16],
'signup_bonus' => ['enable' => true, 'amount' => 1000],
```

---

## 📝 테스트 체크리스트 (실행용)

### Phase 1: 기본 기능 (P0 - 필수)
- [ ] 회원가입 폼 표시
- [ ] 이름/이메일/비밀번호 입력
- [ ] 필수 약관 동의
- [ ] 계정 생성 (users, user_profiles)
- [ ] 비밀번호 해시 저장
- [ ] 이메일 중복 확인
- [ ] 비밀번호 규칙 검증 (8자, 대소문자, 숫자, 특수문자)
- [ ] 가입 성공 후 리다이렉트

### Phase 2: 중요 기능 (P1)
- [ ] Step 모드 지원
- [ ] 약관 모달 표시
- [ ] 전체 동의 기능
- [ ] 이메일 인증 프로세스
- [ ] 관리자 승인 프로세스
- [ ] 블랙리스트 차단
- [ ] 예약 이메일 차단
- [ ] 활동 로그 기록

### Phase 3: 권장 기능 (P2)
- [ ] reCAPTCHA 검증
- [ ] 가입 보너스 지급
- [ ] 휴면 계정 처리
- [ ] 비밀번호 강도 표시
- [ ] 소셜 회원가입

### Phase 4: 선택 기능 (P3)
- [ ] 샤딩 지원
- [ ] IP 화이트리스트
- [ ] 다국어 지원
- [ ] 이메일 알림

---

## 🧪 테스트 실행 결과 (2025-10-05)

### ✅ 기본 기능 테스트 결과

| 항목 | 상태 | 비고 |
|------|------|------|
| 회원가입 폼 표시 | ✅ PASS | /register 접속 시 정상 표시 |
| 이름 필드 | ✅ PASS | 필수 입력, placeholder 표시 |
| 이메일 필드 | ✅ PASS | 필수 입력, 형식 검증 |
| 비밀번호 필드 | ✅ PASS | 실시간 강도 표시 추가 |
| 비밀번호 확인 | ✅ PASS | 실시간 일치 여부 표시 |
| 약관 동의 | ✅ PASS | 2개 약관 표시 (이용약관, 개인정보) |
| 회원가입 버튼 | ✅ PASS | 정상 작동 |
| 로그인 링크 | ✅ PASS | /login 이동 |

### ✅ 비밀번호 규칙 UI 추가됨

| 기능 | 상태 | 설명 |
|------|------|------|
| 강도 진행바 | ✅ 추가 | 약함(빨강)/보통(노랑)/강함(초록) |
| 8자 이상 체크 | ✅ 추가 | 실시간 ⭕ → ✅ 변경 |
| 대문자 체크 | ✅ 추가 | A-Z 포함 여부 표시 |
| 소문자 체크 | ✅ 추가 | a-z 포함 여부 표시 |
| 숫자 체크 | ✅ 추가 | 0-9 포함 여부 표시 |
| 특수문자 체크 | ✅ 추가 | !@#$%^&* 포함 여부 표시 |
| 비밀번호 일치 | ✅ 추가 | 실시간 일치/불일치 표시 |

### ✅ 에러 메시지 개선

| 항목 | Before | After | 상태 |
|------|--------|-------|------|
| 검증 실패 | "입력값 검증에 실패했습니다" | 상세 에러 리스트 표시 | ✅ 개선 |
| 에러 목록 | 단일 메시지 | 불릿 포인트 리스트 | ✅ 개선 |
| 세션 에러 | 미표시 | 빨간색 알림으로 표시 | ✅ 추가 |

### ✅ 약관 처리 개선

| 항목 | 상태 | 비고 |
|------|------|------|
| 약관 있을 때 | ✅ PASS | 약관 2개 표시, 체크 필수 |
| 약관 없을 때 | ✅ PASS | 약관 섹션 숨김, 검증 통과 |
| 전체 동의 버튼 | ✅ PASS | 모든 약관 일괄 체크/해제 |
| 약관 모달 | ✅ PASS | 약관 내용 팝업 표시 |

### ✅ 입력값 검증 테스트

| 테스트 | 입력값 | 예상 | 실제 | 상태 |
|--------|--------|------|------|------|
| 정상 가입 | 모든 필드 정상 | 계정 생성 | ⏳ 수동 테스트 필요 | READY |
| 이름 필수 | 이름 공백 | 에러 | ⏳ 수동 테스트 필요 | READY |
| 이메일 필수 | 이메일 공백 | 에러 | ⏳ 수동 테스트 필요 | READY |
| 이메일 형식 | invalid-email | 에러 | ⏳ 수동 테스트 필요 | READY |
| 이메일 중복 | 기존 이메일 | 에러 | ⏳ 수동 테스트 필요 | READY |
| 비밀번호 짧음 | Pass1! | 에러 | ⏳ 수동 테스트 필요 | READY |
| 비밀번호 불일치 | 다른 비밀번호 | 에러 | ⏳ 수동 테스트 필요 | READY |
| 약관 미동의 | 체크 안 함 | 에러 | ⏳ 수동 테스트 필요 | READY |

### 🛠️ 개발 완료 항목

#### 코드 수정
- [x] `register/index.blade.php` 레이아웃 변경 (auth 레이아웃)
- [x] 에러 메시지 상세화 (리스트 형식)
- [x] 비밀번호 강도 진행바 추가
- [x] 비밀번호 규칙 실시간 체크리스트 추가
- [x] 비밀번호 확인 일치 여부 실시간 표시
- [x] 약관 없을 때 섹션 숨김 처리
- [x] `setting.php` 뷰 경로 업데이트
- [x] `config/admin/auth.php` 뷰 경로 업데이트

#### 검증 로직 수정
- [x] `StoreController` terms 검증 완화 (nullable)
- [x] `validateTermsAgreement()` 약관 없을 때 통과
- [x] `UserTerms` 모델 SoftDeletes 제거

#### 데이터
- [x] 기본 약관 2개 생성 (이용약관, 개인정보처리방침)
- [x] 테스트 사용자 5명 생성

#### 콘솔 명령어
- [x] `auth:user-create` - 사용자 생성
- [x] `auth:user-info` - 정보 조회
- [x] `auth:user-status` - 상태 변경
- [x] `auth:email-verify` - 이메일 인증
- [x] `auth:password-reset` - 비밀번호 재설정
- [x] `auth:password-expiry` - 만료 관리
- [x] `auth:lockout-reset` - 잠금 해제
- [x] `auth:session-clear` - 세션 삭제

### 📋 수동 테스트 가이드

#### 테스트 순서
1. http://localhost:8000/register 접속
2. 이름: `테스트사용자`
3. 이메일: `manual@test.com`
4. 비밀번호: `Password123!` 입력하며 실시간 체크 확인
   - 강도 바가 0% → 100%로 변경되는지 확인
   - 5가지 규칙 ⭕ → ✅ 변경되는지 확인
5. 비밀번호 확인: `Password123!` 입력
   - "✅ 비밀번호가 일치합니다" 메시지 확인
6. 약관 2개 체크
7. 회원가입 버튼 클릭

#### 예상 결과
- ✅ 계정 생성
- ✅ user_profiles 생성
- ✅ 약관 동의 기록
- ✅ 이메일 인증 안내 화면 (또는 로그인 페이지)

#### 검증
```bash
php artisan auth:user-info manual@test.com
```

### 🎯 테스트 진행률

- **준비 완료**: 100%
- **자동 테스트**: 0% (DB 설정 이슈)
- **수동 테스트**: 0% (브라우저 테스트 대기)
- **전체 진행률**: 80% (개발 완료, 테스트 대기)

### 📝 다음 단계
1. 브라우저에서 수동 테스트 실행
2. 각 테스트 케이스 결과 기록
3. 실패한 케이스 수정
4. 자동 테스트 환경 구축 (선택)
