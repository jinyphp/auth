# 로그인 기능 체크리스트

## 📋 목차
1. [기본 로그인 기능](#1-기본-로그인-기능)
2. [인증 방식](#2-인증-방식)
3. [보안 기능](#3-보안-기능)
4. [계정 상태 검증](#4-계정-상태-검증)
5. [세션 관리](#5-세션-관리)
6. [2단계 인증](#6-2단계-인증)
7. [소셜 로그인](#7-소셜-로그인)
8. [리다이렉트 처리](#8-리다이렉트-처리)
9. [UI/UX](#9-uiux)
10. [로그 및 알림](#10-로그-및-알림)

---

## 1. 기본 로그인 기능

### 1.1 로그인 폼 표시
- [ ] `/login` 경로 접속 시 로그인 폼 표시
- [ ] 이메일 입력 필드 표시
- [ ] 비밀번호 입력 필드 표시
- [ ] "로그인 상태 유지" 체크박스 표시
- [ ] "비밀번호 찾기" 링크 표시
- [ ] "회원가입" 링크 표시
- [ ] 로그인 버튼 표시

### 1.2 로그인 처리
- [ ] POST `/login` 요청 처리
- [ ] 이메일 형식 검증
- [ ] 비밀번호 필수 입력 검증
- [ ] CSRF 토큰 검증
- [ ] 이메일/비밀번호 일치 확인
- [ ] 성공 시 홈페이지로 리다이렉트

### 1.3 로그인 비활성화
- [ ] `LOGIN_ENABLE=false` 시 로그인 비활성화 화면 표시
- [ ] 비활성화 화면에 안내 메시지 표시

---

## 2. 인증 방식

### 2.1 세션 기반 인증 (`AUTH_METHOD=session`)
- [ ] 세션 생성 확인
- [ ] 세션 쿠키 저장 확인
- [ ] Remember Me 기능 동작 확인
- [ ] 세션 만료 시간 확인 (120분)
- [ ] 로그아웃 시 세션 삭제 확인

### 2.2 JWT 토큰 인증 (`AUTH_METHOD=jwt`)
- [ ] Access Token 생성 확인
- [ ] Refresh Token 생성 확인
- [ ] 토큰 쿠키 저장 확인 (`access_token`, `refresh_token`)
- [ ] Access Token 만료 시간 확인 (1시간)
- [ ] Refresh Token 만료 시간 확인 (30일)
- [ ] API 요청 시 JSON 응답 확인
- [ ] 웹 요청 시 쿠키 + 리다이렉트 확인

---

## 3. 보안 기능

### 3.1 계정 잠금 (Lockout)
- [ ] 5회 실패 시 15분 잠금 (1단계)
- [ ] 10회 실패 시 60분 잠금 (2단계)
- [ ] 15회 실패 시 영구 잠금 (3단계)
- [ ] 잠금 시 잠금 화면 표시
- [ ] 잠금 해제 시간 표시
- [ ] 60분 시간 윈도우 내 실패 횟수 집계
- [ ] 성공 로그인 시 실패 횟수 초기화

### 3.2 블랙리스트
- [ ] 이메일 블랙리스트 차단
- [ ] IP 블랙리스트 차단
- [ ] 10회 실패 시 자동 블랙리스트 등록
- [ ] 24시간 차단 확인
- [ ] 차단 시 에러 메시지 표시

### 3.3 IP 화이트리스트
- [ ] `ip_whitelist.enable=true` 시 화이트리스트 확인
- [ ] 허용된 IP만 로그인 가능
- [ ] 차단된 IP 접근 시 에러 메시지

### 3.4 reCAPTCHA
- [ ] `RECAPTCHA_ENABLE=true` 시 reCAPTCHA 표시
- [ ] v2: 체크박스 클릭 확인
- [ ] v3: 백그라운드 점수 확인 (0.5 이상)
- [ ] 실패 시 에러 메시지

### 3.5 유지보수 모드
- [ ] `AUTH_MAINTENANCE=true` 시 유지보수 화면 표시
- [ ] 제외 IP는 정상 접속 가능
- [ ] 유지보수 메시지 표시

---

## 4. 계정 상태 검증

### 4.1 삭제된 계정
- [ ] `deleted_at` 존재 시 로그인 차단
- [ ] "삭제된 계정입니다" 메시지 표시

### 4.2 차단된 계정
- [ ] `status='blocked'` 시 로그인 차단
- [ ] 차단 화면으로 리다이렉트
- [ ] 차단 사유 표시

### 4.3 비활성화 계정
- [ ] `status='inactive'` 시 로그인 차단
- [ ] "비활성화된 계정입니다" 메시지 표시

### 4.4 승인 대기 계정
- [ ] `status='pending'` 시 로그인 차단
- [ ] 승인 대기 화면으로 리다이렉트
- [ ] "관리자 승인 대기 중" 메시지 표시

### 4.5 휴면 계정
- [ ] 365일 미접속 시 휴면 전환
- [ ] 휴면 계정 로그인 시 휴면 해제 화면 표시
- [ ] 본인 인증 후 해제

### 4.6 이메일 미인증
- [ ] `email_verified_at=null` 시 이메일 인증 안내 표시
- [ ] 인증 메일 재발송 링크 표시

---

## 5. 세션 관리

### 5.1 동시 세션 제한
- [ ] 최대 3개 세션 허용
- [ ] 3개 초과 시 가장 오래된 세션 종료
- [ ] 세션 목록 확인 가능

### 5.2 세션 수명
- [ ] 120분(2시간) 후 자동 만료
- [ ] 활동 시 세션 연장
- [ ] 만료 시 로그인 페이지로 리다이렉트

---

## 6. 2단계 인증 (2FA)

### 6.1 2FA 활성화 시 (`TWO_FACTOR_ENABLE=true`)
- [ ] 로그인 후 2FA 코드 입력 화면 표시
- [ ] 이메일 방식: 이메일로 코드 발송
- [ ] SMS 방식: SMS로 코드 발송
- [ ] Authenticator 방식: OTP 앱 코드 입력
- [ ] 6자리 코드 검증
- [ ] 5분(300초) 내 입력 필요
- [ ] 실패 시 재시도 가능
- [ ] 복구 코드 사용 가능

### 6.2 2FA 비활성화 시
- [ ] 로그인 즉시 홈으로 이동
- [ ] 2FA 화면 표시 안 함

---

## 7. 소셜 로그인

### 7.1 소셜 로그인 활성화 (`SOCIAL_AUTH_ENABLE=true`)
- [ ] Google 로그인 버튼 표시
- [ ] Facebook 로그인 버튼 표시
- [ ] GitHub 로그인 버튼 표시
- [ ] Kakao 로그인 버튼 표시
- [ ] Naver 로그인 버튼 표시

### 7.2 소셜 로그인 처리
- [ ] `/auth/{provider}` 리다이렉트
- [ ] OAuth 인증 진행
- [ ] `/auth/{provider}/callback` 콜백 처리
- [ ] 기존 계정 연동 확인
- [ ] 신규 사용자 자동 회원가입
- [ ] 로그인 성공 후 홈으로 리다이렉트

### 7.3 개별 제공자 활성화
- [ ] `GOOGLE_AUTH_ENABLE=true` 시 Google 활성화
- [ ] `FACEBOOK_AUTH_ENABLE=true` 시 Facebook 활성화
- [ ] `GITHUB_AUTH_ENABLE=true` 시 GitHub 활성화
- [ ] `KAKAO_AUTH_ENABLE=true` 시 Kakao 활성화
- [ ] `NAVER_AUTH_ENABLE=true` 시 Naver 활성화

---

## 8. 리다이렉트 처리

### 8.1 로그인 성공 후
- [ ] 기본: `/home`으로 리다이렉트
- [ ] `intended()` URL 존재 시 해당 URL로 이동
- [ ] 설정값: `redirect_after_login` 참조

### 8.2 로그아웃 후
- [ ] `/login`으로 리다이렉트
- [ ] 설정값: `redirect_after_logout` 참조

### 8.3 인증 필요 페이지 접근 시
- [ ] 미로그인 시 `/login`으로 리다이렉트
- [ ] 원래 URL 저장 (intended)
- [ ] 로그인 후 원래 URL로 복귀

---

## 9. UI/UX

### 9.1 로그인 화면
- [ ] Bootstrap 테마 적용
- [ ] 반응형 디자인
- [ ] 로고 표시
- [ ] 에러 메시지 표시
- [ ] 성공 메시지 표시
- [ ] 입력값 유지 (이메일)
- [ ] 비밀번호 표시/숨김 토글

### 9.2 다크모드
- [ ] 다크모드 토글 제거됨 (기본 라이트 모드)

### 9.3 다국어
- [ ] `LOCALIZATION_ENABLE=true` 시 다국어 지원
- [ ] 한국어, 영어, 일본어, 중국어 지원
- [ ] 언어 선택 드롭다운 표시

---

## 10. 로그 및 알림

### 10.1 활동 로그
- [ ] 로그인 시도 기록 (`auth_login_attempts`)
- [ ] 성공/실패 여부 기록
- [ ] IP 주소 기록
- [ ] User Agent 기록
- [ ] 실패 사유 기록
- [ ] 타임스탬프 기록

### 10.2 보안 로그
- [ ] 새 디바이스 로그인 시 알림
- [ ] 의심스러운 활동 감지
- [ ] 비정상 로그인 패턴 감지
- [ ] 5년 보관 (`retention.security=1825`)

### 10.3 이메일 알림
- [ ] 새 디바이스 로그인 알림 발송
- [ ] 계정 잠금 알림 발송
- [ ] 비밀번호 변경 알림 발송

---

## 11. 비밀번호 관련

### 11.1 비밀번호 만료
- [ ] 90일 경과 시 만료
- [ ] 만료 시 비밀번호 변경 화면 표시
- [ ] 만료 전 알림

### 11.2 비밀번호 이력
- [ ] 최근 5개 비밀번호 재사용 방지
- [ ] 이력 테이블에 해시 저장

---

## 12. 샤딩 지원

### 12.1 샤딩 활성화 (`SHARDING_ENABLE=true`)
- [ ] UUID 기반 사용자 식별
- [ ] 16개 샤드 분산
- [ ] 이메일 인덱스 테이블 사용
- [ ] ShardedUser 모델 사용

### 12.2 샤딩 비활성화
- [ ] ID 기반 사용자 식별
- [ ] User 모델 사용
- [ ] 단일 DB 사용

---

## 📊 설정별 테스트 매트릭스

| 설정 항목 | 값 | 테스트 항목 | 예상 결과 |
|---------|-----|----------|----------|
| `AUTH_ENABLE` | `true` | 로그인 가능 | ✅ 성공 |
| `AUTH_ENABLE` | `false` | 로그인 시도 | ❌ 시스템 비활성화 메시지 |
| `LOGIN_ENABLE` | `true` | 로그인 폼 접근 | ✅ 폼 표시 |
| `LOGIN_ENABLE` | `false` | 로그인 폼 접근 | ❌ 비활성화 화면 |
| `AUTH_METHOD` | `session` | 로그인 성공 | 세션 쿠키 생성 |
| `AUTH_METHOD` | `jwt` | 로그인 성공 | JWT 토큰 쿠키 생성 |
| `LOCKOUT_ENABLE` | `true` | 5회 실패 | 15분 잠금 |
| `LOCKOUT_ENABLE` | `false` | 무제한 시도 | 잠금 없음 |
| `TWO_FACTOR_ENABLE` | `true` | 로그인 성공 | 2FA 코드 입력 화면 |
| `TWO_FACTOR_ENABLE` | `false` | 로그인 성공 | 즉시 홈 이동 |
| `SOCIAL_AUTH_ENABLE` | `true` | 로그인 화면 | 소셜 버튼 표시 |
| `SOCIAL_AUTH_ENABLE` | `false` | 로그인 화면 | 소셜 버튼 숨김 |
| `RECAPTCHA_ENABLE` | `true` | 로그인 화면 | reCAPTCHA 표시 |
| `RECAPTCHA_ENABLE` | `false` | 로그인 화면 | reCAPTCHA 숨김 |
| `DORMANT_ENABLE` | `true` | 365일 미접속 | 휴면 전환 |
| `DORMANT_ENABLE` | `false` | 365일 미접속 | 정상 로그인 |
| `SHARDING_ENABLE` | `true` | 사용자 생성 | UUID 기반 |
| `SHARDING_ENABLE` | `false` | 사용자 생성 | ID 기반 |

---

## ✅ 우선순위별 테스트

### 🔴 필수 (P0)
1. 이메일/비밀번호 로그인
2. 세션/JWT 토큰 생성
3. 계정 상태 검증 (삭제, 차단, 비활성)
4. 로그인 성공 후 리다이렉트
5. 로그아웃

### 🟡 중요 (P1)
6. 계정 잠금 (5회 실패)
7. 블랙리스트 차단
8. Remember Me
9. 활동 로그 기록
10. 에러 메시지 표시

### 🟢 권장 (P2)
11. 2단계 인증
12. 소셜 로그인
13. reCAPTCHA
14. 휴면 계정
15. 비밀번호 만료

### ⚪ 선택 (P3)
16. IP 화이트리스트
17. 동시 세션 제한
18. 다국어
19. 샤딩
20. 이메일 알림

---

## 🔧 테스트 환경 설정

### 최소 설정
```env
AUTH_ENABLE=true
LOGIN_ENABLE=true
AUTH_METHOD=session
```

### 권장 설정
```env
AUTH_ENABLE=true
LOGIN_ENABLE=true
AUTH_METHOD=jwt
LOCKOUT_ENABLE=true
TWO_FACTOR_ENABLE=false
SOCIAL_AUTH_ENABLE=false
RECAPTCHA_ENABLE=false
DORMANT_ENABLE=true
SHARDING_ENABLE=false
```

### 전체 기능 활성화
```env
AUTH_ENABLE=true
LOGIN_ENABLE=true
AUTH_METHOD=jwt
LOCKOUT_ENABLE=true
TWO_FACTOR_ENABLE=true
SOCIAL_AUTH_ENABLE=true
GOOGLE_AUTH_ENABLE=true
KAKAO_AUTH_ENABLE=true
RECAPTCHA_ENABLE=true
DORMANT_ENABLE=true
SHARDING_ENABLE=true
```

---

## 🛠️ 테스트용 콘솔 명령어

### 사용자 계정 관리

#### 1. 사용자 정보 조회
```bash
php artisan auth:user-info {email}
```
**기능**: 사용자의 상세 정보, 계정 상태, 잠금 상태, 최근 로그인 기록 조회

**출력 예시**:
```
👤 사용자 정보
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
이름:        홍길동
이메일:      user@example.com
UUID:        550e8400-e29b-41d4-a716-446655440000
ID:          1
유형:        USR
상태:        active
이메일 인증: ✅ 인증됨
마지막 로그인: 2025-10-05 12:30:00 (5분 전)
가입일:      2025-10-01 10:00:00 (4일 전)
```

#### 2. 사용자 상태 변경
```bash
php artisan auth:user-status {email} {status} [--reason=]
```
**파라미터**:
- `{email}`: 사용자 이메일
- `{status}`: active|pending|blocked|inactive
- `--reason`: 변경 사유 (선택)

**사용 예시**:
```bash
# 계정 활성화
php artisan auth:user-status user@example.com active

# 계정 차단
php artisan auth:user-status user@example.com blocked --reason="스팸 활동"

# 승인 대기로 변경
php artisan auth:user-status user@example.com pending

# 비활성화
php artisan auth:user-status user@example.com inactive
```

#### 3. 테스트 사용자 생성
```bash
php artisan auth:user-create {email} [options]
```
**옵션**:
- `--name`: 사용자 이름
- `--password`: 비밀번호 (기본: Password123!)
- `--status`: 계정 상태 (기본: active)
- `--verified`: 이메일 인증됨 플래그
- `--admin`: 관리자 계정으로 생성

**사용 예시**:
```bash
# 기본 사용자 생성
php artisan auth:user-create test@example.com

# 인증된 활성 사용자
php artisan auth:user-create active@test.com --verified

# 승인 대기 사용자
php artisan auth:user-create pending@test.com --status=pending

# 차단된 사용자
php artisan auth:user-create blocked@test.com --status=blocked --name="차단테스트"

# 관리자 계정
php artisan auth:user-create admin@test.com --admin --verified
```

---

### 이메일 인증 관리

#### 4. 이메일 인증 상태 변경
```bash
php artisan auth:email-verify {email} [--unverify]
```
**기능**: 이메일 인증 상태 설정/해제

**사용 예시**:
```bash
# 이메일 인증 처리
php artisan auth:email-verify user@example.com

# 이메일 인증 해제
php artisan auth:email-verify user@example.com --unverify
```

---

### 비밀번호 관리

#### 5. 비밀번호 재설정
```bash
php artisan auth:password-reset {email} [password] [--show]
```
**기능**: 사용자 비밀번호 재설정 (자동 생성 가능)

**사용 예시**:
```bash
# 자동 생성된 비밀번호로 재설정
php artisan auth:password-reset user@example.com --show

# 특정 비밀번호로 재설정
php artisan auth:password-reset user@example.com "NewPass123!"

# 비밀번호 표시
php artisan auth:password-reset user@example.com --show
```

#### 6. 비밀번호 만료일 관리
```bash
php artisan auth:password-expiry {email} [options]
```
**옵션**:
- `--days={N}`: N일 후 만료되도록 설정
- `--expire`: 즉시 만료
- `--reset`: 만료 해제

**사용 예시**:
```bash
# 현재 만료 상태 확인
php artisan auth:password-expiry user@example.com

# 즉시 만료 (로그인 시 변경 요구)
php artisan auth:password-expiry user@example.com --expire

# 만료 해제 (오늘로 리셋)
php artisan auth:password-expiry user@example.com --reset

# 5일 후 만료되도록 설정
php artisan auth:password-expiry user@example.com --days=5
```

---

### 계정 잠금 관리

#### 7. 계정 잠금 해제 및 실패 횟수 초기화
```bash
php artisan auth:lockout-reset {email} [--all]
```
**기능**: 계정 잠금 해제 및 로그인 실패 횟수 초기화

**사용 예시**:
```bash
# 특정 사용자 잠금 해제
php artisan auth:lockout-reset user@example.com

# 모든 사용자 잠금 해제
php artisan auth:lockout-reset "" --all
```

---

### 세션 관리

#### 8. 세션 및 JWT 토큰 삭제
```bash
php artisan auth:session-clear [email] [options]
```
**옵션**:
- `--all`: 모든 세션 삭제
- `--expired`: 만료된 세션만 삭제

**사용 예시**:
```bash
# 특정 사용자 세션 삭제 (강제 로그아웃)
php artisan auth:session-clear user@example.com

# 만료된 세션만 정리
php artisan auth:session-clear --expired

# 모든 세션 삭제
php artisan auth:session-clear --all
```

---

## 🧪 콘솔 명령어를 활용한 테스트 시나리오

### 시나리오 1: 차단된 계정 로그인 테스트

**준비**:
```bash
# 1. 테스트 사용자 생성
php artisan auth:user-create blocked@test.com --verified

# 2. 계정 차단
php artisan auth:user-status blocked@test.com blocked --reason="테스트용 차단"

# 3. 상태 확인
php artisan auth:user-info blocked@test.com
```

**테스트**:
```bash
# 브라우저에서 로그인 시도
이메일: blocked@test.com
비밀번호: Password123!
결과: ❌ "차단된 계정입니다" 메시지 + 차단 화면
```

**복구**:
```bash
# 계정 활성화
php artisan auth:user-status blocked@test.com active
```

---

### 시나리오 2: 이메일 미인증 계정 로그인 테스트

**준비**:
```bash
# 1. 미인증 사용자 생성
php artisan auth:user-create unverified@test.com

# 2. 상태 확인 (email_verified_at=null)
php artisan auth:user-info unverified@test.com
```

**테스트**:
```bash
# 로그인 시도
이메일: unverified@test.com
비밀번호: Password123!
결과: ⚠️ "이메일 인증이 필요합니다" + 인증 안내 화면
```

**인증 처리**:
```bash
# 이메일 인증 완료 처리
php artisan auth:email-verify unverified@test.com

# 재시도 → ✅ 로그인 성공
```

---

### 시나리오 3: 계정 잠금 테스트

**준비**:
```bash
# 1. 테스트 사용자 생성
php artisan auth:user-create locktest@test.com --verified

# 2. 현재 상태 확인
php artisan auth:user-info locktest@test.com
```

**테스트**:
```bash
# 1. 틀린 비밀번호로 5회 시도
이메일: locktest@test.com
비밀번호: WrongPassword (5회)
결과: ⚠️ "15분간 로그인 제한" 메시지

# 2. 잠금 상태 확인
php artisan auth:user-info locktest@test.com
# 출력: 🔒 계정 잠금 정보, 실패 횟수: 5회, 잠금 레벨: Level 1
```

**해제**:
```bash
# 잠금 즉시 해제
php artisan auth:lockout-reset locktest@test.com

# 재시도 → ✅ 로그인 성공
```

---

### 시나리오 4: 비밀번호 만료 테스트

**준비**:
```bash
# 1. 테스트 사용자 생성
php artisan auth:user-create expiry@test.com --verified

# 2. 비밀번호 즉시 만료
php artisan auth:password-expiry expiry@test.com --expire

# 3. 만료 상태 확인
php artisan auth:password-expiry expiry@test.com
# 출력: ⚠️ 만료됨 (초과: 1일)
```

**테스트**:
```bash
# 로그인 시도
이메일: expiry@test.com
비밀번호: Password123!
결과: ⚠️ "비밀번호가 만료되었습니다" + 변경 화면
```

**복구**:
```bash
# 새 비밀번호로 재설정
php artisan auth:password-reset expiry@test.com "NewPassword123!" --show

# 만료 해제
php artisan auth:password-expiry expiry@test.com --reset
```

---

### 시나리오 5: 승인 대기 계정 테스트

**준비**:
```bash
# 1. 승인 대기 사용자 생성
php artisan auth:user-create pending@test.com --status=pending --verified

# 2. 상태 확인
php artisan auth:user-info pending@test.com
# 출력: 상태: pending
```

**테스트**:
```bash
# 로그인 시도
이메일: pending@test.com
비밀번호: Password123!
결과: ⚠️ "관리자 승인 대기 중" + 승인 대기 화면
```

**승인 처리**:
```bash
# 계정 활성화
php artisan auth:user-status pending@test.com active --reason="승인 완료"

# 재시도 → ✅ 로그인 성공
```

---

### 시나리오 6: 강제 로그아웃 테스트

**준비**:
```bash
# 1. 사용자 로그인 (브라우저에서)
# 2. 세션 확인
php artisan auth:user-info user@example.com
```

**테스트**:
```bash
# 강제 세션 삭제
php artisan auth:session-clear user@example.com

# 브라우저에서 새로고침
결과: ❌ 세션 만료, /login 리다이렉트
```

---

### 시나리오 7: 다중 상태 조합 테스트

**테스트 케이스 준비**:
```bash
# Case 1: 차단 + 미인증
php artisan auth:user-create case1@test.com --status=blocked
php artisan auth:user-info case1@test.com
# 로그인 → ❌ "차단된 계정"

# Case 2: 활성 + 미인증
php artisan auth:user-create case2@test.com --status=active
php artisan auth:user-info case2@test.com
# 로그인 → ⚠️ "이메일 인증 필요"

# Case 3: 활성 + 인증 + 비밀번호 만료
php artisan auth:user-create case3@test.com --status=active --verified
php artisan auth:password-expiry case3@test.com --expire
php artisan auth:user-info case3@test.com
# 로그인 → ⚠️ "비밀번호 만료"

# Case 4: 비활성 + 인증
php artisan auth:user-create case4@test.com --status=inactive --verified
php artisan auth:user-info case4@test.com
# 로그인 → ❌ "비활성화된 계정"
```

---

## 📋 명령어 체크리스트

### 사용자 관리 명령어
- [ ] `auth:user-info` - 사용자 정보 조회
- [ ] `auth:user-create` - 테스트 사용자 생성
- [ ] `auth:user-status` - 계정 상태 변경 (active/pending/blocked/inactive)

### 인증 관리 명령어
- [ ] `auth:email-verify` - 이메일 인증 상태 변경
- [ ] `auth:email-verify --unverify` - 이메일 인증 해제

### 비밀번호 관리 명령어
- [ ] `auth:password-reset` - 비밀번호 재설정
- [ ] `auth:password-reset --show` - 생성된 비밀번호 표시
- [ ] `auth:password-expiry` - 만료 상태 확인
- [ ] `auth:password-expiry --expire` - 즉시 만료
- [ ] `auth:password-expiry --reset` - 만료 해제
- [ ] `auth:password-expiry --days={N}` - N일 후 만료

### 보안 관리 명령어
- [ ] `auth:lockout-reset` - 계정 잠금 해제
- [ ] `auth:lockout-reset --all` - 모든 계정 잠금 해제

### 세션 관리 명령어
- [ ] `auth:session-clear {email}` - 특정 사용자 세션 삭제
- [ ] `auth:session-clear --all` - 모든 세션 삭제
- [ ] `auth:session-clear --expired` - 만료된 세션 정리

---

## 🎯 명령어 활용 테스트 매트릭스

| 테스트 항목 | 준비 명령어 | 테스트 동작 | 검증 명령어 | Priority |
|----------|----------|----------|-----------|----------|
| 차단된 계정 로그인 | `auth:user-status {email} blocked` | 로그인 시도 | `auth:user-info {email}` | P0 |
| 미인증 계정 로그인 | `auth:user-create {email}` | 로그인 시도 | `auth:user-info {email}` | P0 |
| 승인 대기 계정 | `auth:user-status {email} pending` | 로그인 시도 | `auth:user-info {email}` | P1 |
| 비활성화 계정 | `auth:user-status {email} inactive` | 로그인 시도 | `auth:user-info {email}` | P1 |
| 계정 잠금 (5회) | - | 5회 실패 시도 | `auth:user-info {email}` | P0 |
| 잠금 해제 | `auth:lockout-reset {email}` | 로그인 시도 | `auth:user-info {email}` | P0 |
| 비밀번호 만료 | `auth:password-expiry {email} --expire` | 로그인 시도 | `auth:password-expiry {email}` | P2 |
| 비밀번호 재설정 | `auth:password-reset {email} NewPass123!` | 새 비밀번호로 로그인 | - | P1 |
| 강제 로그아웃 | `auth:session-clear {email}` | 페이지 새로고침 | - | P1 |
| 이메일 인증 | `auth:email-verify {email}` | 로그인 시도 | `auth:user-info {email}` | P0 |

---

## 🚀 빠른 테스트 스크립트

### 전체 상태 테스트 스크립트
```bash
#!/bin/bash

echo "=== 계정 상태 테스트 ==="

# 1. 사용자 생성
php artisan auth:user-create test-active@test.com --verified
php artisan auth:user-create test-blocked@test.com --status=blocked --verified
php artisan auth:user-create test-pending@test.com --status=pending --verified
php artisan auth:user-create test-inactive@test.com --status=inactive --verified
php artisan auth:user-create test-unverified@test.com

echo ""
echo "✅ 테스트 사용자 5명 생성 완료"
echo ""
echo "테스트 계정:"
echo "1. test-active@test.com     (active, verified)     → 로그인 성공 예상"
echo "2. test-blocked@test.com    (blocked, verified)    → 차단 메시지 예상"
echo "3. test-pending@test.com    (pending, verified)    → 승인 대기 예상"
echo "4. test-inactive@test.com   (inactive, verified)   → 비활성화 예상"
echo "5. test-unverified@test.com (active, unverified)   → 이메일 인증 필요 예상"
echo ""
echo "모든 계정 비밀번호: Password123!"
```

### 계정 잠금 테스트 스크립트
```bash
#!/bin/bash

echo "=== 계정 잠금 테스트 ==="

# 사용자 생성
php artisan auth:user-create locktest@test.com --verified

echo ""
echo "다음 단계:"
echo "1. 브라우저에서 locktest@test.com으로 5회 잘못된 비밀번호 입력"
echo "2. 명령어로 잠금 상태 확인:"
echo "   php artisan auth:user-info locktest@test.com"
echo "3. 잠금 해제:"
echo "   php artisan auth:lockout-reset locktest@test.com"
```

### 정리 스크립트
```bash
#!/bin/bash

echo "=== 테스트 데이터 정리 ==="

# 테스트 계정 삭제
php artisan tinker --execute="
\App\Models\User::where('email', 'like', '%@test.com')->delete();
\Jiny\Auth\Models\UserProfile::whereNotNull('user_id')->whereNotIn('user_id', \App\Models\User::pluck('id'))->delete();
echo '✅ 테스트 계정 삭제 완료';
"

# 잠금 해제
php artisan auth:lockout-reset "" --all

# 만료된 세션 정리
php artisan auth:session-clear --expired

echo "✅ 정리 완료"
```

---

## 📊 명령어 치트시트

| 명령어 | 설명 | 예시 |
|--------|------|------|
| `auth:user-info` | 사용자 정보 | `auth:user-info user@test.com` |
| `auth:user-create` | 사용자 생성 | `auth:user-create new@test.com --verified` |
| `auth:user-status` | 상태 변경 | `auth:user-status user@test.com blocked` |
| `auth:email-verify` | 이메일 인증 | `auth:email-verify user@test.com` |
| `auth:password-reset` | 비밀번호 재설정 | `auth:password-reset user@test.com --show` |
| `auth:password-expiry` | 만료 관리 | `auth:password-expiry user@test.com --expire` |
| `auth:lockout-reset` | 잠금 해제 | `auth:lockout-reset user@test.com` |
| `auth:session-clear` | 세션 삭제 | `auth:session-clear user@test.com` |
